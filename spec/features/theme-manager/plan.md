# Implementation Plan

**Plan:** Реализовать управление темами списка блюд из редактора меню, включая хранение настроек и применение на публичной странице.

## Data sources / schemas
- Расширить структуру данных меню в Supabase: добавить поле `theme_config` (JSONB) с параметрами темы (идентификатор предустановленной темы, пользовательские цвета, фон, шрифты).
- Обновить типы в Nuxt (например, `Menu` или аналогичные интерфейсы) для включения конфигурации темы.
- При необходимости подготовить миграцию/скрипт для существующих меню, устанавливая `theme_config` в дефолтное значение.
- Обеспечить сериализацию/десериализацию настроек на клиенте при загрузке и сохранении меню.

## Contracts and interfaces
- Обновить API методов чтения и редактирования меню (Supabase RPC или REST) для работы с `theme_config`.
- Описать интерфейсы для компонентов UI: структура данных темы, доступные пресеты, правила валидации.
- Добавить валидацию входных данных на стороне клиента и сервера: допустимые значения цветов, выбор шрифтов из разрешённого списка.
- Обеспечить обратную совместимость: если в ответе сервера нет `theme_config`, фронтенд использует тему по умолчанию.

## Architecture / Components
- Создать модуль или композицию `useMenuTheme` для работы с состоянием темы (выбор, предпросмотр, сброс, сохранение).
- На странице редактирования меню внедрить компонент «ThemeEditor» с контролами (селект предустановок, color picker/палитра, выбор шрифта, переключатель фонового оформления) и предпросмотром.
- На странице списка блюд внедрить систему CSS-переменных или Tailwind-классов, которые считываются из настроек меню и применяются к корневому элементу страницы.
- Настроить синхронизацию между редактором и предпросмотром через реактивные данные и события (без перезагрузки).
- Добавить защиту от потери данных (подтверждение при выходе без сохранения, автосохранение по требованию заказчика).

## Risks
- Некорректный выбор цветов может привести к проблемам доступности; нужно заранее валидировать контраст и ограничить палитру.
- Сложность внедрения кастомных шрифтов (лицензии, загрузка); возможно ограничить выбор системными или заранее подключёнными шрифтами.
- Увеличение размера ответа API за счёт `theme_config`; следует контролировать размер JSON и избегать хранения крупных изображений.
- Вероятность конфликтов с существующими Tailwind классами при динамическом применении тем; необходимо проработать архитектуру стилей.

## Assumptions
- Supabase проект позволяет добавлять новое JSONB поле без сложных миграций и не требуется пересоздание таблицы.
- У нас есть доступ к существующим компонентам редактора меню для расширения UI.
- Дизайн-макеты и список одобренных цветов/шрифтов будут предоставлены до начала реализации.
