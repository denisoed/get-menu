# Implementation Plan

**Plan:** Сохранить состояние быстрого редактирования меню в localStorage с уникальными ключами на уровне клиента, обеспечить автоматическую подстановку текста при повторном открытии модалки и предусмотреть ручную/автоматическую очистку после успешного сохранения.

## Data sources / schemas

- localStorage браузера — хранение черновиков текста по ключу `fast-edit:<menuId>` или аналогичному безопасному идентификатору.
- Определить способ получения `menuId` из данных модалки (props, store или маршрут) и унифицировать формат ключа.
- При отсутствии доступа к localStorage использовать in-memory fallback внутри жизненного цикла модалки (не сохраняется между перезапусками страницы).

## Contracts and interfaces

- Обновить интерфейс компонента быстрого редактирования: добавить кнопку очистки текста с соответствующим `aria-label` и локализованной подсказкой.
- Обеспечить, чтобы функция отправки изменений возвращала Promise, по успешному завершению которого вызывается очистка localStorage.
- Описать вспомогательные функции: `loadFastEditDraft(menuId)`, `saveFastEditDraft(menuId, value)`, `clearFastEditDraft(menuId)` с обработкой ошибок доступа к storage.
- В тестах замокать localStorage и убедиться в корректном поведении.

## Architecture / Components

- Дополнить composable или компонент модального окна логикой синхронизации с storage (возможно выделить composable `useFastEditDraft`).
- Добавить `watch` или `useDebounceFn` для записи текста в storage при изменении поля ввода.
- Подставлять значения при монтировании модалки/инициализации формы, проверяя SSR окружение (использовать `process.client`).
- Кнопка очистки триггерит обнуление состояния ввода, обновление localStorage и визуальный фокус на поле.
- При успешном API-вызове (получение 200) выполнить очистку ключа и сброс состояния компонента.

## Risks

- Возможные коллизии ключей при некорректном формировании идентификатора меню; требуется безопасная сериализация.
- Ошибки при работе в SSR или при отключенном storage могут приводить к исключениям — нужна защита try/catch и проверки окружения.
- Дублирование логики сохранения в нескольких местах, если не выделить общий helper/composable.
- UX перегруз из-за лишней кнопки — важно корректно вписать в интерфейс и стили.

## Assumptions

- Компонент модалки уже использует Composition API и может быть доработан без полного рефакторинга.
- API редактирования возвращает успешный статус, позволяющий однозначно определить момент очистки.
- Дизайн позволяет добавить кнопку очистки внутри поля ввода без конфликтов с существующими элементами.
