# Implementation Plan

**Plan:** Подключить форму категорий на странице создания меню к Supabase для чтения и управления категориями.

## Data sources / schemas
- Определить структуру таблицы `categories` в Supabase: ключевые поля (id, name, description, sort_order, timestamps) и ограничения (уникальность имени, обязательность полей).
- Проверить наличие индексов на поле сортировки и имени для ускорения выборок и предотвращения дублей.
- При необходимости добавить миграцию в Supabase (через SQL или supabase CLI) для недостающих полей или ограничений.
- Описать формат данных, возвращаемых клиенту, и адаптацию к типам приложения (TypeScript интерфейсы или схемы валидации).

## Contracts and interfaces
- Определить слой доступа к данным: модуль/сервис, инкапсулирующий вызовы Supabase (методы `fetchCategories`, `createCategory`, `updateCategory`, `deleteCategory`).
- Описать интерфейсы запросов/ответов для каждой операции, включая обработку ошибок Supabase (типизированные исключения, коды ошибок).
- Обновить UI-контракт формы: какие поля доступны для редактирования, как отображаются состояния загрузки и ошибки.
- Обеспечить единые сообщения для успешных и ошибочных операций (например, через i18n или централизованный уведомляющий компонент).

## Architecture / Components
- Интегрировать Supabase клиент в существующий слой данных проекта (проверить наличие общих конфигураций).
- Реализовать хук/сервис состояния категорий, поддерживающий загрузку, создание, обновление и удаление с синхронизацией UI.
- Обновить компонент формы категорий: добавить вызовы сервиса, состояния загрузки, блокировку кнопок на время запросов.
- Добавить оптимистичные обновления или перезапрос списка после мутаций; предусмотреть отмену при ошибке.
- Реализовать модальные окна/инлайн-формы для редактирования и подтверждения удаления (если отсутствуют).
- Написать тесты: модульные для сервиса работы с Supabase, компонентные/интеграционные для формы категорий.

## Risks
- Некорректные права доступа в Supabase могут блокировать операции записи — требуется проверка политик RLS.
- Возможные задержки сети приведут к плохому UX, если не продумать индикаторы и повторные запросы.
- Существующие блюда, привязанные к категориям, могут препятствовать удалению — нужна стратегия (запрет удаления или каскадное обновление).
- Разные версии схемы в окружениях (dev/prod) могут вызвать ошибки — важно синхронизировать миграции.

## Assumptions
- Supabase клиент уже настроен в проекте и доступен для импортирования.
- На странице создания меню нет других зависимостей, мешающих интеграции (например, legacy API).
- Требуется уточнение UX для конфликтов (например, подтверждение удаления категории, используемой в меню).
