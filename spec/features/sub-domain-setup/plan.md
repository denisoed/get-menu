# Implementation Plan

**Plan:** Реализовать обязательную секцию выбора сабдомена при создании меню с валидацией, отображением итогового URL и проверкой уникальности имени, а также read-only отображение и копирование сабдомена на странице редактирования меню.

## Data sources / schemas

- Дополнить модель меню в клиентском состоянии полем `subdomain` (строка 3–30 символов, латиница/цифры/дефис) и признаком возможности редактирования.
- Уточнить формат хранения сабдомена в бэкенде; при необходимости обновить схему API создания/обновления меню и контракт получения меню.
- Если используется Supabase/БД, убедиться что колонка `subdomain` индексирована для поиска и уникальности.

## Contracts and interfaces

- Обновить клиентский запрос создания/обновления меню, передавая поле `subdomain`, и убедиться что при чтении меню приходит актуальное значение.
- Реализовать или использовать существующий эндпоинт проверки уникальности `GET /menus/subdomain/{name}` или аналогичный.
- На UI добавить компонент `Input` с постфиксом `.get-menu.com`, локализованные подсказки и сообщения об ошибках.
- Для валидации применить композицию (например, `useForm`/`zod`/кастомный валидатор) с правилами формата и обязательности.
- Для страницы редактирования предусмотреть кнопку копирования сабдомена и toast/alert при успехе или ошибке.

## Architecture / Components

- Обновить страницу/компонент создания меню (вероятно `app/pages/menu/create.vue` или соответствующий модуль) добавив новую секцию выше «Контакты и витрина».
- Вынести логику проверки и отображения статуса в отдельный композиционный хук или локальный `ref` с debounce при обращении к API.
- Отобразить состояний: загрузка проверки, успешное подтверждение, ошибка формата, ошибка занятости, общая ошибка сети.
- Убедиться, что компонент адаптивен: постфикс отображается корректно на мобильных (внутри инпута) и десктопе.
- На странице редактирования меню разместить read-only поле сабдомена с постфиксом и кнопкой копирования, обеспечить доступность (keyboard focus, aria-label).
- Обновить связанные тесты/сторисы, если они есть, для нового поля и кнопки копирования.

## Risks

- Отсутствие готового API проверки уникальности — нужно согласовать и добавить мок/заглушку.
- Потенциальные коллизии при одновременной регистрации одного имени — предусмотреть повторную проверку после отправки формы.
- UX риск: слишком длинные или сложные имена; обеспечить понятные сообщения и ограничения.
- Валидация может конфликтовать с существующими правилами формы — проверить совместимость.

## Assumptions

- Доступ к API проверки уникальности предоставлен и не требует дополнительной авторизации.
- Текущий процесс создания меню позволяет вставить дополнительную секцию без изменения маршрутов.
- Нет требований к миграции старых меню — они могут не иметь сабдомен, будет решено отдельно.
