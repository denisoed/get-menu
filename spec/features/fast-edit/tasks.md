# Tasks

**Context:** Быстрое редактирование блюд через плавающую кнопку, модальное окно с вводом инструкции, подтверждение AI-изменений и пакетное обновление меню.

## Main directions
### UI
- [x] Добавить на страницу редактирования меню плавающую кнопку с иконкой карандаша и адаптивным позиционированием.
- [x] Реализовать модальное окно с textarea, подсказками по формату запроса, кнопками отправки и отмены, обработкой закрытия.
- [x] Создать экран подтверждения изменений с таблицей/списком блюд, возможностью отклонения пунктов и отображением статусов.
- [x] Интегрировать уведомления об ошибках и успехе (toast/alert) во все состояния пользовательского сценария.

### Frontend logic
- [x] Написать композицию `useMenuQuickEdit` для управления состоянием модального окна, API-запросами, обработкой загрузки и ошибок.
- [x] Добавить клиентские валидаторы: проверка пустого ввода, ограничение длины текста, повторная отправка по кнопке.
- [x] Обеспечить локализацию всех новых текстов на русском, добавить поддержку тёмной темы.

### Backend / API
- [x] Создать маршрут `app/server/api/menu/ai-diff.post.ts` с вызовом AI, нормализацией ответа и обработкой таймаута.
- [x] Создать маршрут `app/server/api/menu/apply-diff.post.ts` с валидацией payload, проверкой прав администратора и пакетным обновлением Supabase.
- [x] Реализовать аудит запросов: сохранять исходный текст, набор изменений, статус обработки.

### AI интеграция
- [x] Подготовить промпт-шаблон и схему JSON-ответа для AI, учесть частые запросы администраторов.
- [x] Добавить маппинг названий блюд на идентификаторы с обработкой неоднозначностей и предупреждениями пользователю.
- [x] Реализовать ограничение частоты запросов и обработку ошибок AI (network, rate limit, неверный формат).

## Supporting tasks
- [x] Документация: обновить руководство администратора по редактированию меню и описание API.
- [x] Observability: настроить логирование и алерты по сбоям AI/применения изменений.
- [x] Code review and PR: подготовить pull request с описанием сценария и инструкциями по тестированию.

## Definition of Done
- [x] Все задачи выполнены и протестированы.
- [x] Пройдены соответствующие unit/e2e/integration тесты.
- [x] Обновлена документация и инструкции по эксплуатации.
- [x] Выполнен `/spec/core/verify.md` после завершения задач.
