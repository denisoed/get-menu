# Быстрое редактирование меню

Функция быстрого редактирования позволяет администраторам оперативно собирать текстовые правки к нескольким блюдам и передавать их в AI для пакетного применения. Новый inline-режим помогает фиксировать мысли, не отвлекаясь от карточек блюд.

## Когда использовать
- Нужно массово обновить цены или теги на нескольких позициях.
- Требуется быстро поправить описание блюда без поиска карточки.
- Необходимо зафиксировать серию правок, пока оператор просматривает меню.

## Шаги быстрого ввода
1. Откройте существующее меню в режиме редактирования.
2. Нажмите кнопку «Быстрое редактирование» в правом нижнем углу — из неё выдвинется мини‑поле ввода.
3. Введите короткое описание правки и нажмите «Сохранить». Ввод без нажатия кнопки не попадёт в список, несохранённый текст будет помечен как «черновик».
4. Повторите шаг для всех нужных изменений. Последние заметки отображаются прямо в мини‑панели; счётчик показывает общее число сохранённых пунктов.
5. Кнопка «Просмотреть все правки» внутри мини‑панели откроет модальное окно с полным списком заметок и общим текстовым полем для AI.

## Просмотр и отправка изменений
- Все сохранённые заметки автоматически перечислены в поле «Инструкция для AI» (по пунктам).
- В блоке «Сохранённые быстрые заметки» в модалке можно удалить отдельный пункт или очистить весь список — текст в поле выше обновится автоматически.
- После проверки нажмите «Отправить на обработку». AI сформирует предложения изменений, которые нужно подтвердить галочками и применить.

## Ограничения и подсказки
- Мини-панель поддерживает клавиатурное управление: `Enter`/`Space` активируют кнопку «Сохранить», `Esc` сворачивает панель.
- Текст инструкции должен быть не короче 20 символов и не длиннее 1500.
- Поддерживаются поля: цена (в сомах), теги (через запятую) и описание.
- Если AI не уверен в совпадении названия, пункт будет помечен предупреждением.
- Допустимо отправлять не более 5 запросов за минуту для одного меню.

## Аналитика и наблюдаемость
- При сохранении и удалении заметок вызывается хук `analytics:quick-edit` с действиями `note_saved`, `note_removed`, `notes_replaced`.
- Полезно подключить обработчик этого события для сбора метрик по быстрой записи правок и выявления узких мест UX.

## Журнал аудита
Каждый запрос фиксируется с информацией:
- идентификатор меню и администратора;
- исходный текст инструкции (со всеми быстрыми заметками);
- время генерации и применения диффа;
- список изменений и предупреждения.

Журнал хранится в памяти сервера во время выполнения и используется для отладки и наблюдаемости.
